<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
      .testdata {
        display: flex;
        flex-direction: row;
        font-family: monospace;
      }
      .log {
        display: flex;
        flex-grow: 1;
        flex-direction: column;
      }
      .section {
        background-color: aquamarine;
        font-size: 9px;
        transition: all 0.4s ease-out;
        opacity: 0;
      }
      .failed {
        background-color: red;
      }
      .show {
        opacity: 1;
      }
      div {
        text-align: center;
      }
    </style>
  </head>
  <body>
    <div id='testdata' class='testdata'>
    </div>
    <script>
      var HOST = location.origin.replace(/^http/, 'ws');
      var ws = new WebSocket("ws://radiant-wildwood-39558.herokuapp.com/");
      var el = document.getElementById('testdata');
      var logs = {};
      var logsCount = 0;
      ws.onmessage = function (event) {
        var node = document.createElement("div");
        var data = JSON.parse(event.data);
        console.log(data);
        if (data && data.length === 2) {
          var container = document.createElement("div");
          container.className = "log";
          el.appendChild(container);
          logs[data[0]] = container;
          logsCount++;
        };
        console.log(logs);
        if (data && data.length > 2) {
          if ("START" === data[2] || "END" === data[2]) {
            node.className = "section";
          };
          if (data[3].indexOf("FAIL") !== -1) {
            node.className += " failed";
          }
          var text = document.createTextNode(data[3]);
          node.appendChild(text);
          setTimeout(function() {
            node.className = node.className + " show";
          }, 10);
          logs[data[0]].appendChild(node);
          window.scrollTo(0,document.body.scrollHeight);
        };
      };
    </script>
  </body>
</html>